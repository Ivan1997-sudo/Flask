{% extends 'base.html' %}
{% block title %}{{ book.title_book }}{% endblock %}
{% block content %}
<div class="p-1"></div>
<div class="card text-start p-2">
    <div class="fs-3 fw-bold ">{{ book.title_book }}</div>
    <div class="fs-5">{{ book.author }}, год издания: {{ book.year }} </div>
    <div class="fs-6">
        {% if book.rating != None %}
        Оценка пользователей: {{ book.rating }}
        Количество отзывов: {{ quantity_review }}
        {% else %}
        Оценок пока нет
        {% endif %}
    </div>
</div>
<div class="p-1"></div>

<div class="row">
    <div class="col-8 border">
        <div class="container text-center card">
            <div class="row">
                <div class="col-4 border">
                    <img src="{{ url_for('static', filename=book.title_book + '/1.png') }}" class="img-thumbnail" alt="Обложка {{ book.title_book }}">
                </div>
                <div class="text-start col-8 border">
                    <div class="fs-4 fw-bold">Описание: </div>
                    {{ book.description }}
                </div>
            </div>
        </div>
    </div>

    <div class="col-4 border">
        <div class="container p-2 card">
            <div class="fs-2 fw-bold">
                {{ book.price }} ₽
            </div>
            <div class="container">
                <!--Если пользователи авторизован и у него уже есть в корзине данная книга - даст возможность изменить количество-->
                {% if name and cart_item %}
                    <form action="{{ url_for('cart', title_book=book.title_book, action='-1') }}" method="post" style="display:inline;">
                        <button type="submit" class="btn btn-outline-success">-</button>
                    </form>
                    {{ cart_item.quantity }}
                    <form action="{{ url_for('cart', title_book=book.title_book, action='+1') }}" method="post" style="display:inline;">
                        <button type="submit" class="btn btn-outline-success">+</button>
                    </form>
                    <a class="btn btn-outline-success" href="{{ url_for('cart') }}" role="button">Перейти в корзину </a>
                {% else %}
                    <form action="{{ url_for('cart', title_book=book.title_book, action='+1') }}" method="post" style="display:inline;">
                        <button type="submit" class="btn btn-outline-success">Добавить в корзину</button>
                    </form>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<div class="p-1"></div>
{% if name %}
    <div class="row">
        <div class="col-8 border">
            <div class="container card p-2">
                <form method="post">
                    <div class="mb-3">
                        <label for="review" class="form-label" >Уже читали эту книгу? Поделитесь вашим мнением и поставьте оценку!</label>
                        <textarea class="form-control" id="review" name="review" rows="2" required></textarea>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="estimation" id="1" value="1" required>
                        <label class="form-check-label" for="1">1</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="estimation" id="2" value="2" required>
                        <label class="form-check-label" for="2">2</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="estimation" id="3" value="3" required>
                        <label class="form-check-label" for="3">3</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="estimation" id="4" value="4" required>
                        <label class="form-check-label" for="4">4</label>
                    </div>
                    <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="estimation" id="5" value="5" required>
                        <label class="form-check-label" for="5">5</label>
                    </div>
                    <button type="submit" class="btn btn-outline-success">Отправить</button>
                </form>
            </div>
        </div>
    </div>
{% endif %}

<div class="row">
    <div class="col-8 border">
        <div class="container text-start card border">
            {% if quantity_review > 0 %}
                <div class="fs-4 fw-bold text-center">Отзывы</div>
                {% for review in total_review %}
                    <div class="row">
                        <div class="col-1 border">
                            <img src="{{ url_for('static', filename='/Аватарка.png') }}" alt="Logo" width="50" height="50" class="d-inline-block align-text-top">
                        </div>
                        <div class="col-11 border">
                            <div class="d-flex justify-content-between align-items-center">
                              <div class="fs-5 fw-bold">{{ review.username }}</div>
                              <div>Оценка пользователя: {{ review.estimation }}</div>
                            </div>
                            <div>{{ review.review }}</div>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <div class="fs-4 fw-bold text-center">На данную книгу нет отзывов</div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}